---
title: "Final"
author: "Miguel Angel Malagon - Manuel Camilo Corredor"
date: '2022-05-21'
output: html_document
---

```{r setup, include=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# 1. Measuring fund performance

Librerias
```{r,echo=FALSE, warning=FALSE}
#install.packages("quantmod")
library(quantmod)
#install.packages("kableExtra")
#library(kableExtra)
```

Lista de activos
```{r}
tickers <- c("VSMPX","VFIAX","DODGX","SWPPX","RLBGX","FSGEX","VGHAX",
             "FPCIX","FTBFX","BBCPX","PTTRX","FKINX","CAIBX","ABALX",
             "AGTHX","GFFFX","AMECX","TRBCX","PIMIX","FBKWX")


```

Precio de los activos y rentabilidades
```{r,echo=FALSE}
Prices <- c()
for (activos in tickers){
  Prices <- cbind(Prices,getSymbols.yahoo(
    Symbols =activos,index.class  = 'Date',from ="2017-05-01",
    to="2022-03-02",periodicity = "monthly",auto.assign = FALSE)[,6])
}
colnames(Prices)<-tickers

```

```{r}
Rentabilidad <- c()
n <- ncol(Prices)
for (i in 1:n){

    Rentabilidad <- cbind(Rentabilidad,monthlyReturn(Prices[,i],leading = FALSE))[-1,]
}
colnames(Rentabilidad)<-tickers  
```

```{r}
sharpe_ratio <- round(
  SharpeRatio(Rentabilidad, Rf = 0.0016761), 4
)
?SharpeRatio

```

$$
\frac{\overline{(R_{a}-R_{f})}}{√{σ_{(R_{a}-R_{f})}}}
$$


```{r}
#kable(Prices)
#kable(Rentabilidad
#      )
```

```{r}
# FAMA & FRENCH

library(readxl)
Data_Factors <- read_excel("Data_Factors.xlsx")
```


```{r}
#CALCULAMOS LAS VARIABLES Y (Rentabilidad_activo - RF)

variable_y <- c()
x <- ncol(Rentabilidad)
for (i in 1:x) {
  
  variable_y<- cbind(variable_y,((Rentabilidad[,i])-(Data_Factors$RF)))
}


```


```{r}


Data_Regression <- merge(x=Data_Factors,y=variable_y,by =NULL)

names(Data_Regression)[2] <-"RMRF"

```

```{r}
#Preparamos la Regresión

regression <- lm(VSMPX ~ RMRF + SMB + HML, data = Data_Regression)
summary(regression)

# NOTA: Falta hacer un for que haga cada regresion cambiando el activo y lo coloque en un dataframe


```

